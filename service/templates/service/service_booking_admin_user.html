{% extends "dashboard/admin_layout.html" %}

{% block admin_main_content %}
<div>
    <h1>{{ page_title }} - Existing User</h1>
    <hr>

    {% if messages %}
        <div>
            {% for message in messages %}
                <p>{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}

    <form method="post" id="admin-booking-user-form">
        {% csrf_token %}

        <div>
            <div>
                <h3>Customer Selection</h3>
            </div>
            <div>

                <div>
                    {% if form.user.field.required %}<span class="required-indicator">*</span> {% endif %}<label for="{{ form.user.id_for_label }}">{{ form.user.label }}</label>
                    {{ form.user }}
                    {% if form.user.errors %}
                        <div>
                            {% for error in form.user.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>


                <div>
                    <a href="{% url 'users:admin_create_user' %}" id="add-customer-button">Add New Customer</a>
                </div>
            </div>
        </div>

        <div>
            <div>
                <h3>Customer Details (Editable)</h3>
            </div>
            <div>
                <p id="customer-details-instructions">Select an existing customer to load their details. Details can be edited and will update the user's profile upon booking creation.</p>
                <div>
                    Error loading customer details. Please enter manually or try again.
                </div>

                <div>

                    <label for="{{ form.user_first_name.id_for_label }}">First Name</label>
                    {{ form.user_first_name }}
                    {% if form.user_first_name.errors %}<div>{% for error in form.user_first_name.errors %}{{ error }}{% endfor %}</div>{% endif %}
                </div>

                <div>

                    <label for="{{ form.user_last_name.id_for_label }}">Last Name</label>
                    {{ form.user_last_name }}
                    {% if form.user_last_name.errors %}<div>{% for error in form.user_last_name.errors %}{{ error }}{% endfor %}</div>{% endif %}
                </div>

                <div>

                    <label for="{{ form.user_email.id_for_label }}">Email</label>
                    {{ form.user_email }}
                    {% if form.user_email.errors %}<div>{% for error in form.user_email.errors %}{{ error }}{% endfor %}</div>{% endif %}
                </div>

                <div>

                    <label for="{{ form.user_phone_number.id_for_label }}">{{ form.user_phone_number.label }}</label>
                    {{ form.user_phone_number }}
                    {% if form.user_phone_number.errors %}<div>{% for error in form.user_phone_number.errors %}{{ error }}{% endfor %}</div>{% endif %}
                </div>
            </div>
        </div>

        <div>
            <div>
                <h3>Motorcycle Details</h3>
            </div>
            <div>
                <div>
                    {% if form.bike_selection_type.field.required %}<span class="required-indicator">*</span> {% endif %}{{ form.bike_selection_type.label_tag }}
                    {{ form.bike_selection_type }}
                </div>

                <div>
                    <div>

                        <span class="required-indicator">*</span> <label for="{{ form.existing_motorcycle.id_for_label }}">{{ form.existing_motorcycle.label }}</label>
                        {{ form.existing_motorcycle }}
                        {% if form.existing_motorcycle.errors %}
                            <div>
                                {% for error in form.existing_motorcycle.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <div>
                    <h4>Motorcycle Details</h4>
                    <div>

                        <span class="required-indicator">*</span> <label for="{{ form.new_bike_make.id_for_label }}">{{ form.new_bike_make.label }}</label>
                        {{ form.new_bike_make }}
                        {% if form.new_bike_make.errors %}<div>{% for error in form.new_bike_make.errors %}{{ error }}{% endfor %}</div>{% endif %}
                    </div>
                    <div>

                        <span class="required-indicator">*</span> <label for="{{ form.new_bike_model.id_for_label }}">{{ form.new_bike_model.label }}</label>
                        {{ form.new_bike_model }}
                        {% if form.new_bike_model.errors %}<div>{% for error in form.new_bike_model.errors %}{{ error }}{% endfor %}</div>{% endif %}
                    </div>
                    <div>

                        <span class="required-indicator">*</span> <label for="{{ form.new_bike_year.id_for_label }}">{{ form.new_bike_year.label }}</label>
                        {{ form.new_bike_year }}
                        {% if form.new_bike_year.errors %}<div>{% for error in form.new_bike_year.errors %}{{ error }}{% endfor %}</div>{% endif %}
                    </div>
                    <div>

                        <label for="{{ form.new_bike_rego.id_for_label }}">{{ form.new_bike_rego.label }}</label>
                        {{ form.new_bike_rego }}
                        {% if form.new_bike_rego.errors %}<div>{% for error in form.new_bike_rego.errors %}{{ error }}{% endfor %}</div>{% endif %}
                    </div>
                     <div>

                        <label for="{{ form.new_bike_vin_number.id_for_label }}">{{ form.new_bike_vin_number.label }}</label>
                        {{ form.new_bike_vin_number }}
                        {% if form.new_bike_vin_number.errors %}<div>{% for error in form.new_bike_vin_number.errors %}{{ error }}{% endfor %}</div>{% endif %}
                    </div>
                    <div>

                        <label for="{{ form.new_bike_odometer.id_for_label }}">{{ form.new_bike_odometer.label }}</label>
                        {{ form.new_bike_odometer }}
                        {% if form.new_bike_odometer.errors %}<div>{% for error in form.new_bike_odometer.errors %}{{ error }}{% endfor %}</div>{% endif %}
                    </div>
                    <div>

                        <label for="{{ form.new_bike_transmission.id_for_label }}">{{ form.new_bike_transmission.label }}</label>
                        {{ form.new_bike_transmission }}
                        {% if form.new_bike_transmission.errors %}<div>{% for error in form.new_bike_transmission.errors %}{{ error }}{% endfor %}</div>{% endif %}
                    </div>
                </div>
            </div>
        </div>
        <br>

        <div>
            <div>
                <h3>Service Details</h3>
            </div>
            <div>
                <div>
                    {% if form.service_type.field.required %}<span class="required-indicator">*</span> {% endif %}<label for="{{ form.service_type.id_for_label }}">{{ form.service_type.label }}</label>
                    {{ form.service_type }}
                    {% if form.service_type.errors %}<div>{% for error in form.service_type.errors %}{{ error }}{% endfor %}</div>{% endif %}
                </div>

                <div>
                    {% if form.appointment_date.field.required %}<span class="required-indicator">*</span> {% endif %}<label for="{{ form.appointment_date.id_for_label }}">{{ form.appointment_date.label }}</label>
                    {{ form.appointment_date }}
                    {% if form.appointment_date.errors %}<div>{% for error in form.appointment_date.errors %}{{ error }}{% endfor %}</div>{% endif %}
                </div>

                <div>

                    <label for="{{ form.booking_comments.id_for_label }}">{{ form.booking_comments.label }}</label>
                    {{ form.booking_comments }}
                    {% if form.booking_comments.errors %}<div>{% for error in form.booking_comments.errors %}{{ error }}{% endfor %}</div>{% endif %}
                </div>
            </div>
        </div>

        <div>
            <button type="submit">Create Booking for User</button>
        </div>
    </form>
</div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'js/service_booking_admin_user.js' %}"></script>   
{% endblock %}
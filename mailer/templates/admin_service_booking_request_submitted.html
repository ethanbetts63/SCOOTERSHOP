{% extends "email_layout.html" %}
{% load static %}

{% block title %}NEW SERVICE BOOKING: {{ booking.service_booking_reference | default:'Reference Missing' }}{% endblock %}

{% block content %}
    <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
        <tr>
            <td style="padding: 20px 0; text-align: center;">
                <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="600" class="container">
                    <tr>
                        <td class="header">
                            <h1>New Service Booking Received!</h1>
                        </td>
                    </tr>
                    <tr>
                        <td class="content">
                            <p>Dear Administrator,</p>
                            <p>A new motorcycle service booking has been confirmed. Please find the full details below:</p>

                            <!-- Booking Overview Section -->
                            <div class="section-title">Booking Overview</div>
                            <table class="details-table" width="100%" cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="label" width="40%">Booking Reference:</td>
                                    <td class="value"><strong>{{ booking.service_booking_reference | default:'Not available' }}</strong></td>
                                </tr>
                                <tr>
                                    <td class="label">Status:</td>
                                    <td class="value">{{ booking.get_booking_status_display | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Created At:</td>
                                    <td class="value">{{ booking.created_at|date:"D, M d, Y H:i" | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Last Updated:</td>
                                    <td class="value">{{ booking.updated_at|date:"D, M d, Y H:i" | default:'Not available' }}</td>
                                </tr>
                            </table>

                            <!-- Service Details Section -->
                            <div class="section-title">Service Details</div>
                            <table class="details-table" width="100%" cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="label" width="40%">Service Type:</td>
                                    <td class="value">{{ booking.service_type.name | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Service Date:</td>
                                    <td class="value">{{ booking.service_date|date:"D, M d, Y" | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Drop-off Date/Time:</td>
                                    <td class="value">
                                        {% if booking.after_hours_drop_off %}
                                            <strong style="color: #dc3545;">AFTER-HOURS DROP-OFF</strong>
                                        {% else %}
                                            {{ booking.dropoff_date|date:"D, M d, Y" | default:'N/A' }} at {{ booking.dropoff_time|time:"P" | default:'N/A' }}
                                        {% endif %}
                                    </td>
                                </tr>
                                {% if service_settings.enable_estimated_pickup_date %}
                                <tr>
                                    <td class="label">Estimated Pick-up Date:</td>
                                    <td class="value">{{ booking.estimated_pickup_date|date:"D, M d, Y" | default:'Not set' }}</td>
                                </tr>
                                {% endif %}
                            </table>

                            <!-- Customer Profile Details Section -->
                            <div class="section-title">Customer Profile Details</div>
                            {% if booking.service_profile %}
                            <table class="details-table" width="100%" cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="label" width="40%">Name:</td>
                                    <td class="value">{{ booking.service_profile.name | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Email:</td>
                                    <td class="value">{{ booking.service_profile.email | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Phone Number:</td>
                                    <td class="value">{{ booking.service_profile.phone_number | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label" style="vertical-align: top;">Address:</td>
                                    <td class="value">
                                        {{ booking.service_profile.address_line_1 | default:'' }}<br>
                                        {% if booking.service_profile.address_line_2 %}{{ booking.service_profile.address_line_2 }}<br>{% endif %}
                                        {{ booking.service_profile.city | default:'' }}, {{ booking.service_profile.state | default:'' }} {{ booking.service_profile.post_code | default:'' }}<br>
                                        {{ booking.service_profile.country | default:'' }}
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label">Linked User:</td>
                                    <td class="value">{% if booking.service_profile.user %}{{ booking.service_profile.user.email }} (ID: {{ booking.service_profile.user.id }}){% else %}N/A{% endif %}</td>
                                </tr>
                            </table>
                            {% else %}
                            <p>No customer profile details available.</p>
                            {% endif %}

                            <!-- Customer Motorcycle Details Section -->
                            <div class="section-title">Customer Motorcycle Details</div>
                            {% if booking.customer_motorcycle %}
                            <table class="details-table" width="100%" cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="label" width="40%">Make:</td>
                                    <td class="value">{{ booking.customer_motorcycle.brand | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Model:</td>
                                    <td class="value">{{ booking.customer_motorcycle.model | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Year:</td>
                                    <td class="value">{{ booking.customer_motorcycle.year | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">License Plate:</td>
                                    <td class="value">{{ booking.customer_motorcycle.license_plate | default:'Not available' }}</td>
                                </tr>
                            </table>
                            {% else %}
                            <p>No customer motorcycle details available.</p>
                            {% endif %}

                            <!-- Financial Details Section -->
                            <div class="section-title">Financial Details</div>
                            <table class="details-table" width="100%" cellspacing="0" cellpadding="0" border="0">
                                <tr>
                                    <td class="label" width="40%">Calculated Total:</td>
                                    <td class="value"><strong>{{ booking.calculated_total|floatformat:2 | default:'0.00' }} {{ booking.currency | default:'AUD' }}</strong></td>
                                </tr>
                                <tr>
                                    <td class="label">Amount Paid:</td>
                                    <td class="value">{{ booking.amount_paid|floatformat:2 | default:'0.00' }} {{ booking.currency | default:'AUD' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Payment Status:</td>
                                    <td class="value">{{ booking.get_payment_status_display | default:'Not available' }}</td>
                                </tr>
                                <tr>
                                    <td class="label">Payment Method:</td>
                                    <td class="value">{{ booking.get_payment_method_display | default:'Not available' }}</td>
                                </tr>
                                {% if booking.stripe_payment_intent_id %}
                                <tr>
                                    <td class="label">Stripe Payment Intent ID:</td>
                                    <td class="value">{{ booking.stripe_payment_intent_id }}</td>
                                </tr>
                                {% endif %}
                            </table>

                            <div class="section-title">Customer Notes</div>
                            <p>{% if booking.customer_notes %}{{ booking.customer_notes }}{% else %}No notes provided.{% endif %}</p>

                        </td>
                    </tr>
                    <tr>
                        <td class="footer">
                            <p>&copy; {{ "now"|date:"Y" }} SCOOTER_SHOP. This is an automated notification.</p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
{% endblock %}

{% block extra_styles %}
<style>
    .section-title {
        font-size: 18px;
        font-weight: bold;
        margin-top: 20px;
        margin-bottom: 10px;
        border-bottom: 1px solid #dddddd;
        padding-bottom: 5px;
    }
    .details-table td {
        padding: 8px 0;
        font-size: 14px;
    }
    .details-table .label {
        font-weight: bold;
        color: #555555;
    }
    .details-table .value {
        text-align: left;
    }
</style>
{% endblock %}
